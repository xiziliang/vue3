<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>
<style>
  #canvas {
    background-color: #ccc;
  }
</style>

<body>
  <canvas id="canvas" width="512" height="512"> </canvas>
</body>
<script  src="../js/vector2DCopy.js"></script>

<script>
  /** @type {HTMLCanvasElement} */

  //==================canvas start=================
  function drawBranch(context, v0, length, weight, dir, bias) {
    /** 函数drawBranch
     * @param context // 上下文  
     * @param v0   // 起始向量 
     * @param length   // 树长度
     * @param weight  //树宽度
     * @param dir  // 树枝方向
     * @param bias  // 随机偏向因子
     */
    const v = new Vector2D(1, 0).rotate(dir).scale(length);
    const v1 = v0.copy().add(v);
    context.lineWidth = weight;
    context.beginPath();
    context.moveTo(...v0);
    context.lineTo(...v1);
    context.stroke();

    if (weight > 2) {
      const left = dir - 0.2;
      // const left = Math.PI / 4 + 0.5 * (dir + 0.2) + bias * (Math.random() - 0.5);
      drawBranch(context, v1, length * 0.9, weight * 0.8, left, bias + 0.9);
      const right = dir + 0.2;
      // const right = Math.PI / 4 + 0.5 * (dir - 0.2) + bias * (Math.random() - 0.5);
      drawBranch(context, v1, length * 0.9, weight * 0.8, right, bias + 0.9);
    }

    if (weight < 5 && Math.random() < 0.3) {
      context.save();
      const th = Math.random() * 6 + 3; // 把点放大
      context.lineWidth = th;
      context.beginPath();
      context.moveTo(...v1);
      context.lineTo(v1.x, v1.y - 1);
      context.strokeStyle = "#c72c35";
      context.stroke();
      context.restore();
    }
  }
  // 两个向量垂直 点成 a·b = 0;   两个向量平行时 点成  a·b=|a|*|b|;
  // 两个线段 斜率 相乘等于-1 表示 垂直; 相等表示 平行;
  // a·b = |a|*|b|*cos
  // |a X b| = |a||b|*sin
  const canvas = document.getElementById("canvas");
  let ctx = canvas.getContext("2d");

  ctx.translate(0, canvas.height);
  ctx.scale(1, -1);
  ctx.lineCap = "round";

  const v0 = new Vector2D(256, 0);
  drawBranch(ctx, v0, 50, 10, Math.PI / 2, 3);
  //==================canvas end======================

  const vv = new Vector2D(1, 1);
  const isInRange = new Vector2D(0, 1).dot(vv.normalize()) >= Math.cos(Math.PI / 6);
  console.log(isInRange)
</script>

</html>